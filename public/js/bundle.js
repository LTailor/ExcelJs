!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";(new(function(e){return e&&e.__esModule?e:{default:e}}(r(1)).default)).init(document.getElementById("excel_table"),1e3,100)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cellRefs=new Map,this.cellFormulas=new Map,this.lexer=new a.Lexer,this.syntax=new a.SyntaxParser(this)}return n(e,[{key:"init",value:function(e,t,r){var n=document.createElement("div");n.setAttribute("style","width: "+80*r+"px"),this.table=n;var a=document.createElement("div"),i=document.createElement("div");i.classList.add("cell","first_caption"),a.appendChild(i);for(var o=0;o<r;o++){var u=this.convertToNumberingScheme(o+1),l=document.createElement("div");l.classList.add("cell","caption"),l.innerText=u,a.appendChild(l)}n.appendChild(a),a=document.createElement("div");for(var s=0;s<t;s++){a.setAttribute("data-row",s+1),n.appendChild(a);var c=document.createElement("div");c.classList.add("cell","first_caption"),c.innerText=s+1,a.appendChild(c);for(var d=0;d<r;d++){var f=document.createElement("div");f.classList.add("cell");var v=this.convertToNumberingScheme(d+1),p=s+1;f.setAttribute("data-cell",v),a.appendChild(f),this.setCellEventListeners(f,p,v)}a=document.createElement("div")}e.appendChild(n)}},{key:"setCellEventListeners",value:function(e,t,r){var n=this,a=r+t;e.addEventListener("focus",function(e){console.log("focus"),e.target.innerText=n.getCellValue(t,r)}),e.addEventListener("blur",function(i){var o=n.lexer.parse(i.target.innerText);console.log("blur"),console.log(o),o.forEach(function(e){if("address"===e.type){var a=n.cellRefs.get(e.value);a||(a=n.cellRefs.set(e.value,[]).get(e.value)),a.push({col:r,row:t})}}),n.cellFormulas.set(a,i.target.innerText);try{e.innerText=n.syntax.parse(i.target.innerText)}catch(e){return void alert(e)}n.cellRefs.has(a)&&n.cellRefs.get(a).forEach(function(e){var t=n.getCellValue(e.row,e.col);n.table.querySelector('[data-row="'+e.row+'"]').querySelector('[data-cell="'+e.col+'"]').innerText=n.syntax.parse(t)})},!0)}},{key:"getCellValue",value:function(e,t){if(this.table){var r=this.cellFormulas.get(t+e);return r||this.table.querySelector('[data-row="'+e+'"]').querySelector('[data-cell="'+t+'"]').innerText}}},{key:"convertToNumberingScheme",value:function(e){var t="A".charCodeAt(0),r="";do{e-=1,r=String.fromCharCode(t+e%26)+r,e=e/26>>0}while(e>0);return r}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(){i(this,e)}return n(e,[{key:"parse",value:function(e){var t=this.getNumberTokens(e),r=this.getOperationTokens(e),n=this.getHighPriorityOperations(e);return[].concat(a(t),a(r),a(n)).sort(function(e,t){return e.index-t.index})}},{key:"getNumberTokens",value:function(e){for(var t=/(\d+\.?\d*)|([a-z]+[0-9]+)/gi,r=void 0,n=[];null!==(r=t.exec(e));)r[1]?n.push({type:"number",index:r.index,value:r[0]}):r[2]&&n.push({type:"address",index:r.index,value:r[0]});return n}},{key:"getOperationTokens",value:function(e){for(var t=/[+|-]/gi,r=void 0,n=[];null!==(r=t.exec(e));)n.push({type:"op",index:r.index,value:r[0]});return n}},{key:"getHighPriorityOperations",value:function(e){for(var t=/[*|\/]/gi,r=void 0,n=[];null!==(r=t.exec(e));)n.push({type:"high_op",index:r.index,value:r[0]});return n}}]),e}(),u=function(){function e(t){i(this,e),this.table=t,this.lexer=new o}return n(e,[{key:"parse",value:function(e){if("="!==e[0])return e;var t=this.lexer.parse(e);return this.expression(t,0).value}},{key:"expression",value:function(e,t){return this.lowPriorityExpr(e,t)}},{key:"lowPriorityExpr",value:function(e,t){var r;if(!e[(r=this.highPriorityExpr(e,t)).nextPos])return r;if("op"==e[r.nextPos].type){var n=this.lowPriorityExpr(e,r.nextPos+1),a={};return"+"==e[r.nextPos].value?a.value=r.value+n.value:a.value=r.value-n.value,a.nextPos=n.nextPos,a}}},{key:"highPriorityExpr",value:function(e,t){var r=void 0;if("number"!=e[t].type&&"address"!=e[t].type)throw"Number or address is expected";if(r=this.getValue(e,t),!e[t+1]||"high_op"!=e[t+1].type)return{value:r,nextPos:t+1};var n={},a=this.highPriorityExpr(e,t+2);return"*"==e[t+1].value?n.value=r*a.value:n.value=r/a.value,n.nextPos=a.nextPos,n}},{key:"getValue",value:function(e,t){if("number"==e[t].type)return parseFloat(e[t].value);if("address"==e[t].type){var r=/([a-z]+)(\d+)/i.exec(e[t].value),n=this.table.getCellValue(r[2],r[1]);return parseFloat(this.parse(n))}}}]),e}();t.Lexer=o,t.SyntaxParser=u}]);